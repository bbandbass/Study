{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"collapsed_sections":[],"toc_visible":true,"authorship_tag":"ABX9TyMVcyLWsFdvwN5kJXF2G8Z3"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"6bee831c0146484cbe8d821d479a162e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ac5ef34893444dafad2f876883c0a78a","IPY_MODEL_69556cbbcf4f4a1eb68ef94ab8649efb","IPY_MODEL_c8f6c9f9c4a043408bd005dc14618336"],"layout":"IPY_MODEL_03cc81757520409db05f48c8193a43c4"}},"ac5ef34893444dafad2f876883c0a78a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b486ebd9585b4f12804b1b2f1ec60144","placeholder":"​","style":"IPY_MODEL_44ebed1ccab14121b6fabf3090304ee0","value":"Downloading: 100%"}},"69556cbbcf4f4a1eb68ef94ab8649efb":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_415ae90bd83d483b9117850c17f79f36","max":629,"min":0,"orientation":"horizontal","style":"IPY_MODEL_1e31bde8917e424b92f6777d56a2ec7b","value":629}},"c8f6c9f9c4a043408bd005dc14618336":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f93ea0d23c77460eac73ffc4c34d688e","placeholder":"​","style":"IPY_MODEL_3a5f4af943b7451baf46bec1397ffbf7","value":" 629/629 [00:00&lt;00:00, 16.0kB/s]"}},"03cc81757520409db05f48c8193a43c4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b486ebd9585b4f12804b1b2f1ec60144":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"44ebed1ccab14121b6fabf3090304ee0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"415ae90bd83d483b9117850c17f79f36":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1e31bde8917e424b92f6777d56a2ec7b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f93ea0d23c77460eac73ffc4c34d688e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3a5f4af943b7451baf46bec1397ffbf7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"272d6dfec422487d8e35c5a025093bf4":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_00cbf16bb96945c78cf33f34a87f8974","IPY_MODEL_0b1679e49ce341f0818097cca338a559","IPY_MODEL_83ba1ae5406549958868c00c92776b2b"],"layout":"IPY_MODEL_eb6eaae4ff464c7daf6324ee9b00339f"}},"00cbf16bb96945c78cf33f34a87f8974":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1fc21ad6c848489c8631e2f2ff4214b3","placeholder":"​","style":"IPY_MODEL_8826abcf29384599a8818ebcf34494aa","value":"Downloading: 100%"}},"0b1679e49ce341f0818097cca338a559":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_73a6628ab23148ea99b5dfc09eae194b","max":267844284,"min":0,"orientation":"horizontal","style":"IPY_MODEL_bda0c5f63c3e48f385422479649977a5","value":267844284}},"83ba1ae5406549958868c00c92776b2b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5eba2ff2b77242afaeffb724df230317","placeholder":"​","style":"IPY_MODEL_b6760803a3b5493db2b03843632f4317","value":" 268M/268M [00:05&lt;00:00, 49.8MB/s]"}},"eb6eaae4ff464c7daf6324ee9b00339f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1fc21ad6c848489c8631e2f2ff4214b3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8826abcf29384599a8818ebcf34494aa":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"73a6628ab23148ea99b5dfc09eae194b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bda0c5f63c3e48f385422479649977a5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5eba2ff2b77242afaeffb724df230317":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b6760803a3b5493db2b03843632f4317":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2ff37d3e745d43aeab861ba9d8e784dc":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e4269d0ecce641f2be5fc04aacd440d2","IPY_MODEL_254d1e0bbb46449f8096215d6e2bd53f","IPY_MODEL_8f41319adfc54686a1a2612a01a9acc7"],"layout":"IPY_MODEL_b41b4cfd1ce848cda9c86fb3e6856dde"}},"e4269d0ecce641f2be5fc04aacd440d2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5e57fcf546514eb5817cb145a129abf3","placeholder":"​","style":"IPY_MODEL_a5d239de5355462693356124aa6e4214","value":"Downloading: 100%"}},"254d1e0bbb46449f8096215d6e2bd53f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_66e1ca35d4084969a1d234bac5af9e59","max":48,"min":0,"orientation":"horizontal","style":"IPY_MODEL_da2e68f5420a4aacb847dbebb73829a1","value":48}},"8f41319adfc54686a1a2612a01a9acc7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a6794592966649f5aa3c8a89b567c6c9","placeholder":"​","style":"IPY_MODEL_e9bdee5003574ce09836014d2c7d989f","value":" 48.0/48.0 [00:00&lt;00:00, 907B/s]"}},"b41b4cfd1ce848cda9c86fb3e6856dde":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5e57fcf546514eb5817cb145a129abf3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a5d239de5355462693356124aa6e4214":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"66e1ca35d4084969a1d234bac5af9e59":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"da2e68f5420a4aacb847dbebb73829a1":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a6794592966649f5aa3c8a89b567c6c9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e9bdee5003574ce09836014d2c7d989f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"84c09cf4247c400a8d3f9210deaf5aec":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_fb2f8d25332d420cb42854f5ce76b3d5","IPY_MODEL_579ded57f7f94f898eda8cfe816813f8","IPY_MODEL_7379aa046bcd4a1da0405b2115f8122c"],"layout":"IPY_MODEL_6d945998a6d74ff8a30137b15705c8b5"}},"fb2f8d25332d420cb42854f5ce76b3d5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cf3695b724134594b72af863658b850b","placeholder":"​","style":"IPY_MODEL_168148c66e8c4b4cb8363a1dc9a200c7","value":"Downloading: 100%"}},"579ded57f7f94f898eda8cfe816813f8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2221f95d8dcf49baaf258401267a72cd","max":231508,"min":0,"orientation":"horizontal","style":"IPY_MODEL_cd62b1ba8a4a4d3894419d4bfc5edfe5","value":231508}},"7379aa046bcd4a1da0405b2115f8122c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_26047b76c90d45f3a24cb7f37fb3b79d","placeholder":"​","style":"IPY_MODEL_856d8f84baa840b48dda91ced546694f","value":" 232k/232k [00:00&lt;00:00, 3.99MB/s]"}},"6d945998a6d74ff8a30137b15705c8b5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cf3695b724134594b72af863658b850b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"168148c66e8c4b4cb8363a1dc9a200c7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2221f95d8dcf49baaf258401267a72cd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cd62b1ba8a4a4d3894419d4bfc5edfe5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"26047b76c90d45f3a24cb7f37fb3b79d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"856d8f84baa840b48dda91ced546694f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d66e88aee377412982940a54d2114d29":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8bbb52b9c1534518bbbfa6b309dc8460","IPY_MODEL_07445855ff5b4f3696bd99cdd178a086","IPY_MODEL_fbefa435a7ea4951922d3a7e18b1f03c"],"layout":"IPY_MODEL_8f9a7acb508f4e0ebc5e44383d52155d"}},"8bbb52b9c1534518bbbfa6b309dc8460":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9a00ba89247d4946be03aa6a13117b80","placeholder":"​","style":"IPY_MODEL_0ec3814cc95342679a2083e91a080c22","value":"Downloading: 100%"}},"07445855ff5b4f3696bd99cdd178a086":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_791c90c350a24c74ac063cf89c0ff87e","max":570,"min":0,"orientation":"horizontal","style":"IPY_MODEL_2d68c1c81c884009898d453f995a0d1c","value":570}},"fbefa435a7ea4951922d3a7e18b1f03c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_580fbd89af994183a511ae687d111802","placeholder":"​","style":"IPY_MODEL_32316ae567374859901eb0ad830ecf0f","value":" 570/570 [00:00&lt;00:00, 8.69kB/s]"}},"8f9a7acb508f4e0ebc5e44383d52155d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9a00ba89247d4946be03aa6a13117b80":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0ec3814cc95342679a2083e91a080c22":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"791c90c350a24c74ac063cf89c0ff87e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2d68c1c81c884009898d453f995a0d1c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"580fbd89af994183a511ae687d111802":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"32316ae567374859901eb0ad830ecf0f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0ae081dfbec8460f926b8aae909232aa":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ecaedf9905e947f1951e4e4e4981e7a5","IPY_MODEL_8b3821eac30e4f3b85af21168ed3bc8b","IPY_MODEL_601c9ab2af1c4cc6b2ffaac86ebd6737"],"layout":"IPY_MODEL_87be413a7d194fcdae193eb1862125d6"}},"ecaedf9905e947f1951e4e4e4981e7a5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_886a95cbc9c44f59b94fb6263ac5804c","placeholder":"​","style":"IPY_MODEL_81ee2d7f36934b0dac2a044688af364f","value":"Downloading: 100%"}},"8b3821eac30e4f3b85af21168ed3bc8b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_59a206f5eb3f49939aa9e2164220f0bf","max":435779157,"min":0,"orientation":"horizontal","style":"IPY_MODEL_986cae71cf6242b98d848631c94d5c4e","value":435779157}},"601c9ab2af1c4cc6b2ffaac86ebd6737":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2a01813ea4aa4eb0bc44e84b3a7af4c8","placeholder":"​","style":"IPY_MODEL_7341f2c7d83144af826058676d02a3c9","value":" 436M/436M [00:16&lt;00:00, 47.6MB/s]"}},"87be413a7d194fcdae193eb1862125d6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"886a95cbc9c44f59b94fb6263ac5804c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"81ee2d7f36934b0dac2a044688af364f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"59a206f5eb3f49939aa9e2164220f0bf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"986cae71cf6242b98d848631c94d5c4e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"2a01813ea4aa4eb0bc44e84b3a7af4c8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7341f2c7d83144af826058676d02a3c9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b029742bf3ff4266b7a76af9d187045c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_c56d64506f464660a4149c3f178cd78f","IPY_MODEL_48ee5d6bcd6b423ab4311aab34d92d05","IPY_MODEL_e8d767dc0d004b739102101a0ef9dda7"],"layout":"IPY_MODEL_495c8ce24245463c9f9f65f7c139872e"}},"c56d64506f464660a4149c3f178cd78f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_86ec4496cf3240ef8d3a2fccf6bd515e","placeholder":"​","style":"IPY_MODEL_04ac781e185c45b088c3df890165b83c","value":"Downloading: 100%"}},"48ee5d6bcd6b423ab4311aab34d92d05":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_ed7a5cc58f76431db5e3cdbd9c163abf","max":213450,"min":0,"orientation":"horizontal","style":"IPY_MODEL_77ad8747434940059d99936333c4b257","value":213450}},"e8d767dc0d004b739102101a0ef9dda7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e30b868fab8b46a98dbe9df97ac645cc","placeholder":"​","style":"IPY_MODEL_e03b2c0fa31341f48f6f45d77a53525f","value":" 213k/213k [00:00&lt;00:00, 668kB/s]"}},"495c8ce24245463c9f9f65f7c139872e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"86ec4496cf3240ef8d3a2fccf6bd515e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"04ac781e185c45b088c3df890165b83c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ed7a5cc58f76431db5e3cdbd9c163abf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"77ad8747434940059d99936333c4b257":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"e30b868fab8b46a98dbe9df97ac645cc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e03b2c0fa31341f48f6f45d77a53525f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4ba2b9f3490842be94a7629a6412d696":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_96b86f50e96c4d3ab595e434d175cd20","IPY_MODEL_21affbc98c424c3ab966e28e57ec0996","IPY_MODEL_8aa3078141314924a934d35c1c9507b9"],"layout":"IPY_MODEL_1a2cd04b12bb4f10a9a04db07cf70386"}},"96b86f50e96c4d3ab595e434d175cd20":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f8728c2ff18a4d2fb3ca41a9555ec521","placeholder":"​","style":"IPY_MODEL_7070bebe6c164a6fa93c04db91160e73","value":"Downloading: 100%"}},"21affbc98c424c3ab966e28e57ec0996":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4314cc54247a4cdb8692b12683a11d9a","max":29,"min":0,"orientation":"horizontal","style":"IPY_MODEL_145c537ece8b49609b6e1c9e2a8998f1","value":29}},"8aa3078141314924a934d35c1c9507b9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_44394e75e01a410ab1acd6c100e9c1d9","placeholder":"​","style":"IPY_MODEL_18f0e0a64c7d44a8876ad20a20e5189f","value":" 29.0/29.0 [00:00&lt;00:00, 343B/s]"}},"1a2cd04b12bb4f10a9a04db07cf70386":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f8728c2ff18a4d2fb3ca41a9555ec521":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7070bebe6c164a6fa93c04db91160e73":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4314cc54247a4cdb8692b12683a11d9a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"145c537ece8b49609b6e1c9e2a8998f1":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"44394e75e01a410ab1acd6c100e9c1d9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"18f0e0a64c7d44a8876ad20a20e5189f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"97579bd7aa39458db69b9c0611e87410":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e6582ff150ba4f02afdca0416b1ad7fa","IPY_MODEL_459bfc275f4e4be4b1afc6d847e37996","IPY_MODEL_3628622ae3da4bacb27e09f9bf5c75a7"],"layout":"IPY_MODEL_805580269c2342959bf9178ed2123841"}},"e6582ff150ba4f02afdca0416b1ad7fa":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e412e0c20bdf44f6ba44faebfe73f528","placeholder":"​","style":"IPY_MODEL_ac842f139d3a4c1a8ebe3f3cd851d08e","value":"Downloading: 100%"}},"459bfc275f4e4be4b1afc6d847e37996":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_158f896f6b9c4668bc54f419e9b3c5ed","max":435797,"min":0,"orientation":"horizontal","style":"IPY_MODEL_c2dc52bb1ca7449c8709e31beac70a1c","value":435797}},"3628622ae3da4bacb27e09f9bf5c75a7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f70e4665166b4057855e63dd6a63f492","placeholder":"​","style":"IPY_MODEL_0db494c02ee243dbbf7dc6873e95a69d","value":" 436k/436k [00:00&lt;00:00, 1.70MB/s]"}},"805580269c2342959bf9178ed2123841":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e412e0c20bdf44f6ba44faebfe73f528":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ac842f139d3a4c1a8ebe3f3cd851d08e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"158f896f6b9c4668bc54f419e9b3c5ed":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c2dc52bb1ca7449c8709e31beac70a1c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f70e4665166b4057855e63dd6a63f492":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0db494c02ee243dbbf7dc6873e95a69d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dgo3DqV0Uezt","executionInfo":{"status":"ok","timestamp":1668516573005,"user_tz":-540,"elapsed":10970,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"82ac9f4a-63be-4731-d966-9cfefcbf8e91"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Downloading transformers-4.24.0-py3-none-any.whl (5.5 MB)\n","\u001b[K     |████████████████████████████████| 5.5 MB 22.1 MB/s \n","\u001b[?25hRequirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.7/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.64.1)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.21.6)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.8.0)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (21.3)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.13.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2022.6.2)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1\n","  Downloading tokenizers-0.13.2-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.6 MB)\n","\u001b[K     |████████████████████████████████| 7.6 MB 51.1 MB/s \n","\u001b[?25hRequirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Collecting huggingface-hub<1.0,>=0.10.0\n","  Downloading huggingface_hub-0.10.1-py3-none-any.whl (163 kB)\n","\u001b[K     |████████████████████████████████| 163 kB 56.5 MB/s \n","\u001b[?25hRequirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0,>=0.10.0->transformers) (4.1.1)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers) (3.0.9)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers) (3.10.0)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2022.9.24)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Installing collected packages: tokenizers, huggingface-hub, transformers\n","Successfully installed huggingface-hub-0.10.1 tokenizers-0.13.2 transformers-4.24.0\n"]}],"source":["!pip install transformers"]},{"cell_type":"code","source":["from transformers import pipeline\n","\n","classifier = pipeline(\"sentiment-analysis\")\n","classifier(\n","    [\"I've been waiting for a HuggingFace course my whole life.\",\n","     \"I hate this so much!\",\n","     ]\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":236,"referenced_widgets":["6bee831c0146484cbe8d821d479a162e","ac5ef34893444dafad2f876883c0a78a","69556cbbcf4f4a1eb68ef94ab8649efb","c8f6c9f9c4a043408bd005dc14618336","03cc81757520409db05f48c8193a43c4","b486ebd9585b4f12804b1b2f1ec60144","44ebed1ccab14121b6fabf3090304ee0","415ae90bd83d483b9117850c17f79f36","1e31bde8917e424b92f6777d56a2ec7b","f93ea0d23c77460eac73ffc4c34d688e","3a5f4af943b7451baf46bec1397ffbf7","272d6dfec422487d8e35c5a025093bf4","00cbf16bb96945c78cf33f34a87f8974","0b1679e49ce341f0818097cca338a559","83ba1ae5406549958868c00c92776b2b","eb6eaae4ff464c7daf6324ee9b00339f","1fc21ad6c848489c8631e2f2ff4214b3","8826abcf29384599a8818ebcf34494aa","73a6628ab23148ea99b5dfc09eae194b","bda0c5f63c3e48f385422479649977a5","5eba2ff2b77242afaeffb724df230317","b6760803a3b5493db2b03843632f4317","2ff37d3e745d43aeab861ba9d8e784dc","e4269d0ecce641f2be5fc04aacd440d2","254d1e0bbb46449f8096215d6e2bd53f","8f41319adfc54686a1a2612a01a9acc7","b41b4cfd1ce848cda9c86fb3e6856dde","5e57fcf546514eb5817cb145a129abf3","a5d239de5355462693356124aa6e4214","66e1ca35d4084969a1d234bac5af9e59","da2e68f5420a4aacb847dbebb73829a1","a6794592966649f5aa3c8a89b567c6c9","e9bdee5003574ce09836014d2c7d989f","84c09cf4247c400a8d3f9210deaf5aec","fb2f8d25332d420cb42854f5ce76b3d5","579ded57f7f94f898eda8cfe816813f8","7379aa046bcd4a1da0405b2115f8122c","6d945998a6d74ff8a30137b15705c8b5","cf3695b724134594b72af863658b850b","168148c66e8c4b4cb8363a1dc9a200c7","2221f95d8dcf49baaf258401267a72cd","cd62b1ba8a4a4d3894419d4bfc5edfe5","26047b76c90d45f3a24cb7f37fb3b79d","856d8f84baa840b48dda91ced546694f"]},"id":"huhGgPRbVd3i","executionInfo":{"status":"ok","timestamp":1668516609996,"user_tz":-540,"elapsed":14161,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"c233f42a-9751-4209-baad-f88890cfd394"},"execution_count":2,"outputs":[{"output_type":"stream","name":"stderr","text":["No model was supplied, defaulted to distilbert-base-uncased-finetuned-sst-2-english and revision af0f99b (https://huggingface.co/distilbert-base-uncased-finetuned-sst-2-english).\n","Using a pipeline without specifying a model name and revision in production is not recommended.\n"]},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/629 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6bee831c0146484cbe8d821d479a162e"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/268M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"272d6dfec422487d8e35c5a025093bf4"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/48.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"2ff37d3e745d43aeab861ba9d8e784dc"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/232k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"84c09cf4247c400a8d3f9210deaf5aec"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["[{'label': 'POSITIVE', 'score': 0.9598049521446228},\n"," {'label': 'NEGATIVE', 'score': 0.9994558691978455}]"]},"metadata":{},"execution_count":2}]},{"cell_type":"markdown","source":["#1. Pipeline 내부 실행 과정"],"metadata":{"id":"V-CRfW1HXLXt"}},{"cell_type":"markdown","source":["## 토크나이저를 이용한 전처리"],"metadata":{"id":"Stnhezb3XOiV"}},{"cell_type":"markdown","source":["토크나이저의 역할\n","\n","1.   입력을 token이라 부를 수 있는 word, subword 또는 symbol로 분할\n","2.   각 token을 integer mapping\n","3.   모델에 유용할 수 있는 additional inputs 추가\n","\n","* Architecture: 모델의 뼈대를 의미, 모델 내에서 발생하는 각 레이어(layer)와 오퍼레이션(operation)등을 정의\n","* Checkpoint: 해당 architecture에서 로드될 가중치 값들\n"],"metadata":{"id":"Pn_h2OG3XRKV"}},{"cell_type":"code","source":["from transformers import AutoTokenizer\n","\n","checkpoint = \"distilbert-base-uncased-finetuned-sst-2-english\"\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)"],"metadata":{"id":"BWUXfU1UVsLs","executionInfo":{"status":"ok","timestamp":1668517422981,"user_tz":-540,"elapsed":287,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}}},"execution_count":3,"outputs":[]},{"cell_type":"code","source":["raw_inputs = [\n","    \"I've been waiting for a HuggingFace course my whole life.\",\n","    \"I hate this so much!\",\n","    ]\n","\n","# return_tensors는 토크나이저가 반환하는 텐서의 유형을 지정하는 파라미터로 PyTorch, TensorFlow, Numpy등으로 지정할 수 있다.\n","inputs = tokenizer(raw_inputs, padding = True, truncation = True, return_tensors = \"pt\")\n","print(inputs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"pzbeVBvfY2FN","executionInfo":{"status":"ok","timestamp":1668517732736,"user_tz":-540,"elapsed":432,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"e3207993-5241-456b-8734-afd8707ae7b6"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["{'input_ids': tensor([[  101,  1045,  1005,  2310,  2042,  3403,  2005,  1037, 17662, 12172,\n","          2607,  2026,  2878,  2166,  1012,   102],\n","        [  101,  1045,  5223,  2023,  2061,  2172,   999,   102,     0,     0,\n","             0,     0,     0,     0,     0,     0]]), 'attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],\n","        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0]])}\n"]}]},{"cell_type":"markdown","source":["## 모델 살펴보기"],"metadata":{"id":"eORQuEhybgxn"}},{"cell_type":"code","source":["from transformers import AutoModel\n","\n","checkpoint = \"distilbert-base-uncased-finetuned-sst-2-english\"\n","model = AutoModel.from_pretrained(checkpoint)\n","\n","# 이전과 동일한 체크포인트를 다운로드하고 모델을 초기화"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7BgUz1WTaB4i","executionInfo":{"status":"ok","timestamp":1668518179233,"user_tz":-540,"elapsed":2220,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"8c98284c-4584-4385-a446-069cc497a4b5"},"execution_count":5,"outputs":[{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at distilbert-base-uncased-finetuned-sst-2-english were not used when initializing DistilBertModel: ['pre_classifier.bias', 'classifier.weight', 'classifier.bias', 'pre_classifier.weight']\n","- This IS expected if you are initializing DistilBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing DistilBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n"]}]},{"cell_type":"markdown","source":["## 고차원 벡터?\n","\n","Transformer 모듈의 벡터 출력은 일반적으로 3가지 차원으로 이루어짐\n","\n","\n","*   Batch Size: 한 번에 처리되는 sequence의 수 (위의 예제: 2)\n","*   Sequence Length: sequence 숫자 표현의 길이 (위의 예제: 16)\n","*   Hidden size: 각 모델 입력의 벡터 차원\n","\n","Hidden size가 일반적으로 굉장히 크기 때문에 고차원 벡터라고 나타남  \n","작은 모델은 일반적으로 768, 큰 모델은 3072 이상일 수도 있음  \n"],"metadata":{"id":"OKVz0MdJcMTD"}},{"cell_type":"code","source":["outputs = model(**inputs)\n","print(outputs.last_hidden_state.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"RGtq72j9buOL","executionInfo":{"status":"ok","timestamp":1668518478327,"user_tz":-540,"elapsed":296,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"b98ebde1-cc3d-411b-b28a-b219db644c07"},"execution_count":6,"outputs":[{"output_type":"stream","name":"stdout","text":["torch.Size([2, 16, 768])\n"]}]},{"cell_type":"markdown","source":["## Model heads: 숫자 이해하기\n","  \n","Model head는 hidden states의 고차원 벡터를 입력으로 받아 다른 차원에 projection  \n","일반적으로 하나, 혹은 몇 개의 linear layers로 구성"],"metadata":{"id":"Pc6Cp7N3dhcZ"}},{"cell_type":"code","source":["# 해당 섹션의 예시에서는 sequence classification head가 포함되어 있는 모델이 필요하기 때문에\n","# AutoModel이 아닌 sequence classfication head가 포함되어있는 AutoModelForSequenceClassification 사용\n","from transformers import AutoModelForSequenceClassification\n","\n","checkpoint = \"distilbert-base-uncased-finetuned-sst-2-english\"\n","model = AutoModelForSequenceClassification.from_pretrained(checkpoint)\n","outputs = model(**inputs)\n","print(outputs.logits.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"c_cqyN4jc36h","executionInfo":{"status":"ok","timestamp":1668519078924,"user_tz":-540,"elapsed":1388,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"01f9f275-93df-46e3-bd5d-5435d7b7cba9"},"execution_count":10,"outputs":[{"output_type":"stream","name":"stdout","text":["torch.Size([2, 2])\n"]}]},{"cell_type":"markdown","source":["두 개의 문장과 두 개의 레이블만 있기 때문에 2 x 2의 shape이 출력됨  \n","기존의 2 x 16 x 768보다 차원이 훨씬 낮아진 것을 확인할 수 있음"],"metadata":{"id":"T3kNcbJ9fIzX"}},{"cell_type":"markdown","source":["## 출력 후처리하기"],"metadata":{"id":"8s4VD0uXfYlR"}},{"cell_type":"code","source":["print(outputs.logits)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YxDtfvDHfEGs","executionInfo":{"status":"ok","timestamp":1668519150161,"user_tz":-540,"elapsed":484,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"72fb331a-bcf9-4eae-fe00-edbb510a0f02"},"execution_count":11,"outputs":[{"output_type":"stream","name":"stdout","text":["tensor([[-1.5607,  1.6123],\n","        [ 4.1692, -3.3464]], grad_fn=<AddmmBackward0>)\n"]}]},{"cell_type":"markdown","source":["모델의 output이 항상 의미 있는 값은 아닌데, 위의 예시에서도 단순한 logit 점수를 출력하고 있다.  \n","이를 확률값으로 변환하기 위해서는 softmax 계층을 통과해야한다.  \n","모든 Transformers의 loss function은 일반적으로 최종 activation function으로 softmax를, 손실함수로는 cross entropy를 사용하여 구현되기 때문이다."],"metadata":{"id":"b7f8PzGbfft2"}},{"cell_type":"code","source":["# 문장별 특정 레이블에 속할 확률\n","import torch\n","predictions = torch.nn.functional.softmax(outputs.logits, dim = -1)\n","print(predictions)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"oognHhQtfbtt","executionInfo":{"status":"ok","timestamp":1668519298536,"user_tz":-540,"elapsed":283,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"dce6fdca-8873-4659-ec30-342d3f1457a5"},"execution_count":12,"outputs":[{"output_type":"stream","name":"stdout","text":["tensor([[4.0195e-02, 9.5980e-01],\n","        [9.9946e-01, 5.4418e-04]], grad_fn=<SoftmaxBackward0>)\n"]}]},{"cell_type":"code","source":["# 각 레이블이 무엇인지 확인하기 위함\n","model.config.id2label"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ciDK8AdkgAKs","executionInfo":{"status":"ok","timestamp":1668519330379,"user_tz":-540,"elapsed":668,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"49ccc7fc-95cf-45ad-c840-dd2365eeda6f"},"execution_count":13,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{0: 'NEGATIVE', 1: 'POSITIVE'}"]},"metadata":{},"execution_count":13}]},{"cell_type":"markdown","source":["## 혼자 해보기"],"metadata":{"id":"1wCdBuslga--"}},{"cell_type":"code","source":["classifier = pipeline(\"sentiment-analysis\")\n","classifier(\n","    [\"I hate cucumber.\",\n","     \"I love listening to music.\",\n","     ]\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"RD_-4rwqgHyZ","executionInfo":{"status":"ok","timestamp":1668519629080,"user_tz":-540,"elapsed":2490,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"d9196cba-4264-42f6-a534-2eaebf1a5d72"},"execution_count":20,"outputs":[{"output_type":"stream","name":"stderr","text":["No model was supplied, defaulted to distilbert-base-uncased-finetuned-sst-2-english and revision af0f99b (https://huggingface.co/distilbert-base-uncased-finetuned-sst-2-english).\n","Using a pipeline without specifying a model name and revision in production is not recommended.\n"]},{"output_type":"execute_result","data":{"text/plain":["[{'label': 'NEGATIVE', 'score': 0.9956943988800049},\n"," {'label': 'POSITIVE', 'score': 0.999747097492218}]"]},"metadata":{},"execution_count":20}]},{"cell_type":"code","source":["checkpoint = \"distilbert-base-uncased-finetuned-sst-2-english\"\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)"],"metadata":{"id":"xcqjlC5QgkSl","executionInfo":{"status":"ok","timestamp":1668519629080,"user_tz":-540,"elapsed":6,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}}},"execution_count":21,"outputs":[]},{"cell_type":"code","source":["raw_inputs = [\n","    \"I hate cucumber.\",\n","    \"I love listening to music.\",\n","    ]\n","\n","# return_tensors는 토크나이저가 반환하는 텐서의 유형을 지정하는 파라미터로 PyTorch, TensorFlow, Numpy등으로 지정할 수 있다.\n","inputs = tokenizer(raw_inputs, padding = True, truncation = True, return_tensors = \"pt\")\n","print(inputs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"IU0zXBWJgtFk","executionInfo":{"status":"ok","timestamp":1668519629080,"user_tz":-540,"elapsed":5,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"c983e913-f768-4cf3-e663-deeeb796073d"},"execution_count":22,"outputs":[{"output_type":"stream","name":"stdout","text":["{'input_ids': tensor([[  101,  1045,  5223, 12731, 24894,  5677,  1012,   102],\n","        [  101,  1045,  2293,  5962,  2000,  2189,  1012,   102]]), 'attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1],\n","        [1, 1, 1, 1, 1, 1, 1, 1]])}\n"]}]},{"cell_type":"code","source":["checkpoint = \"distilbert-base-uncased-finetuned-sst-2-english\"\n","model = AutoModelForSequenceClassification.from_pretrained(checkpoint)\n","outputs = model(**inputs)\n","\n","predictions = torch.nn.functional.softmax(outputs.logits, dim = -1)\n","print(model.config.id2label)\n","print(predictions)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YFiyAw1LhCHM","executionInfo":{"status":"ok","timestamp":1668519629919,"user_tz":-540,"elapsed":843,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"546d8525-40d7-406c-bd86-bc30fdf8c185"},"execution_count":23,"outputs":[{"output_type":"stream","name":"stdout","text":["{0: 'NEGATIVE', 1: 'POSITIVE'}\n","tensor([[9.9569e-01, 4.3055e-03],\n","        [2.5286e-04, 9.9975e-01]], grad_fn=<SoftmaxBackward0>)\n"]}]},{"cell_type":"markdown","source":["# 2. Models"],"metadata":{"id":"peq9ZJbshrnp"}},{"cell_type":"markdown","source":["## 트랜스포머 모델 생성하기"],"metadata":{"id":"I6vGT751i5rZ"}},{"cell_type":"code","source":["from transformers import BertConfig, BertModel\n","\n","# BERT모델을 초기화하기 위해서는 가장 먼저 configurateion(설정) 객체를 로드해야함\n","# config(설정) 만들기\n","config = BertConfig()\n","\n","# 해당 config에서 모델 생성\n","model = BertModel(config)"],"metadata":{"id":"Q4sFI5CZhtFh","executionInfo":{"status":"ok","timestamp":1668520254848,"user_tz":-540,"elapsed":3437,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}}},"execution_count":24,"outputs":[]},{"cell_type":"code","source":["# configuration 객체에는 모델을 빌드하는데 필요한 많은 속성이 포함되어 있음\n","print(config)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ZRF21Ekgjo2X","executionInfo":{"status":"ok","timestamp":1668520257226,"user_tz":-540,"elapsed":297,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"4869bfe5-f325-4cf0-d414-859918e8e9f1"},"execution_count":25,"outputs":[{"output_type":"stream","name":"stdout","text":["BertConfig {\n","  \"attention_probs_dropout_prob\": 0.1,\n","  \"classifier_dropout\": null,\n","  \"hidden_act\": \"gelu\",\n","  \"hidden_dropout_prob\": 0.1,\n","  \"hidden_size\": 768,\n","  \"initializer_range\": 0.02,\n","  \"intermediate_size\": 3072,\n","  \"layer_norm_eps\": 1e-12,\n","  \"max_position_embeddings\": 512,\n","  \"model_type\": \"bert\",\n","  \"num_attention_heads\": 12,\n","  \"num_hidden_layers\": 12,\n","  \"pad_token_id\": 0,\n","  \"position_embedding_type\": \"absolute\",\n","  \"transformers_version\": \"4.24.0\",\n","  \"type_vocab_size\": 2,\n","  \"use_cache\": true,\n","  \"vocab_size\": 30522\n","}\n","\n"]}]},{"cell_type":"markdown","source":["## 다른 loading methods\n","\n","위의 모델은 학습되지 않은 모델로 당연히 성능이 좋지 않다  \n","따라서 먼저 학습이 진행되어야하는데, 이보단 pretrained model을 사용하는 것이 현명"],"metadata":{"id":"LloTHjrjj6G5"}},{"cell_type":"code","source":["model = BertModel.from_pretrained(\"bert-base-cased\")\n","# BertConfig를 사용하지 않고 bert-base-cased를 통해 사전 학습된 모델 로드"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":155,"referenced_widgets":["d66e88aee377412982940a54d2114d29","8bbb52b9c1534518bbbfa6b309dc8460","07445855ff5b4f3696bd99cdd178a086","fbefa435a7ea4951922d3a7e18b1f03c","8f9a7acb508f4e0ebc5e44383d52155d","9a00ba89247d4946be03aa6a13117b80","0ec3814cc95342679a2083e91a080c22","791c90c350a24c74ac063cf89c0ff87e","2d68c1c81c884009898d453f995a0d1c","580fbd89af994183a511ae687d111802","32316ae567374859901eb0ad830ecf0f","0ae081dfbec8460f926b8aae909232aa","ecaedf9905e947f1951e4e4e4981e7a5","8b3821eac30e4f3b85af21168ed3bc8b","601c9ab2af1c4cc6b2ffaac86ebd6737","87be413a7d194fcdae193eb1862125d6","886a95cbc9c44f59b94fb6263ac5804c","81ee2d7f36934b0dac2a044688af364f","59a206f5eb3f49939aa9e2164220f0bf","986cae71cf6242b98d848631c94d5c4e","2a01813ea4aa4eb0bc44e84b3a7af4c8","7341f2c7d83144af826058676d02a3c9"]},"id":"pcSUj8o0jqK-","executionInfo":{"status":"ok","timestamp":1668520477038,"user_tz":-540,"elapsed":19097,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"7243f71b-f051-4d90-df3e-0b7a9e87ad98"},"execution_count":26,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/570 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"d66e88aee377412982940a54d2114d29"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/436M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"0ae081dfbec8460f926b8aae909232aa"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight']\n","- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n"]}]},{"cell_type":"markdown","source":["## Saving methods"],"metadata":{"id":"YT2z17Ylm-vh"}},{"cell_type":"code","source":["model.save_pretrained(\"saving_folder\")"],"metadata":{"id":"zS5KimCukbQh","executionInfo":{"status":"ok","timestamp":1668521163809,"user_tz":-540,"elapsed":3134,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}}},"execution_count":29,"outputs":[]},{"cell_type":"code","source":["ls saving_folder"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"RJ-0MNfCnDiA","executionInfo":{"status":"ok","timestamp":1668521174323,"user_tz":-540,"elapsed":28,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"103e912d-874d-4f89-d565-fa9ad682ff48"},"execution_count":30,"outputs":[{"output_type":"stream","name":"stdout","text":["config.json  pytorch_model.bin\n"]}]},{"cell_type":"markdown","source":["## 트랜스포머 모델을 활용한 추론"],"metadata":{"id":"xkA_fLr4n541"}},{"cell_type":"code","source":["sequences = [\"Hello!\", \"Cool.\", \"Nice!\"]"],"metadata":{"id":"X6pRrq3YnJ1H","executionInfo":{"status":"ok","timestamp":1668521396696,"user_tz":-540,"elapsed":587,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}}},"execution_count":31,"outputs":[]},{"cell_type":"code","source":["encoded_sequences = [\n","    [101, 7592, 999, 102],\n","    [101, 4658, 1012, 102],\n","    [101, 3835, 99, 102],\n","]"],"metadata":{"id":"qME5X2NCoAWT","executionInfo":{"status":"ok","timestamp":1668521505679,"user_tz":-540,"elapsed":300,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}}},"execution_count":32,"outputs":[]},{"cell_type":"code","source":["# array를 tensor로 변환\n","model_inputs = torch.tensor(encoded_sequences)"],"metadata":{"id":"LG4Fa1y7oa73","executionInfo":{"status":"ok","timestamp":1668521527996,"user_tz":-540,"elapsed":326,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}}},"execution_count":33,"outputs":[]},{"cell_type":"markdown","source":["## 모델의 입력으로 텐서 활용"],"metadata":{"id":"UP9ra4DGoqaE"}},{"cell_type":"code","source":["output = model(model_inputs)"],"metadata":{"id":"5nhks7YWoofE","executionInfo":{"status":"ok","timestamp":1668521580618,"user_tz":-540,"elapsed":278,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}}},"execution_count":35,"outputs":[]},{"cell_type":"markdown","source":["# 3. 토크나이저\n","입력된 텍스트를 모델에서 처리할 수 있는 데이터로 변환  \n","모델은 숫자만 처리할 수 있으므로, 토크나이저는 텍스트 입력을 숫자 데이터로 변환"],"metadata":{"id":"liyr1ahjo-2V"}},{"cell_type":"markdown","source":["## 단어 기반 토큰화(Word-based Tokenization)\n","\n","vocabulary에 없는 단어를 표현하기 위해서는 unknown tokekn([UNK])와 같은 사용자 정의 토큰이 필요한데, unknown token이 많이 등장하는 것은 토크나이저가 해당 단어의 합당한 표현을 찾을 수 없고, 그 과정에서 정보를 많이 잃어버린다는 뜻이므로 나쁜 징조이다. 따라서 이런 unknown token이 최대한 적게 출력되게끔 하는 것이 목표이고, 이를 위한 한 가지 방법으로 문자 기반 토크나이저를 사용하는 것이 있다."],"metadata":{"id":"eIc_cth5pbE4"}},{"cell_type":"code","source":["tokenized_text = \"Jim Henson was a puppeteer\".split()\n","print(tokenized_text)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"E4xuwJCSotGL","executionInfo":{"status":"ok","timestamp":1668521911734,"user_tz":-540,"elapsed":4,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"9fdc78f0-9e17-46b1-ffa8-af6932b17892"},"execution_count":36,"outputs":[{"output_type":"stream","name":"stdout","text":["['Jim', 'Henson', 'was', 'a', 'puppeteer']\n"]}]},{"cell_type":"markdown","source":["## 문자 기반 토큰화(Character-based Tokenization)\n","vocabulary의 크기가 단어 기반 토큰화보다 훨씬 작다.  \n","모든 단어들이 문자를 가지고 만들어질 수 있기 때문에, OOV(out-of-vocabulary) 토큰이 훨씬 적다.  \n","그러나 분리된 토큰 표현이 문자이기 때문에 토큰의 의미 파악이 어렵다. \n","모델에서 처리해야하는 양의 토큰이 매우 많아진다.  \n","단어 기반 토큰화에서는 하나의 토큰으로 표현되던 하나의 단어가 문자 기반 토큰화에서는 스무 개의 토큰이 될 수도 있다.  \n","단어 기반 토큰화와 문자 기반 토큰화의 장점을 결합한 하위 단어 토큰화(subword tokenization)을 사용할 수 있다."],"metadata":{"id":"ReR0edbKrJjp"}},{"cell_type":"markdown","source":["## 하위 단어 토큰화(Subword Tokenization)\n","빈번하게 사용되는 단어에 대해서는 subwords로 분할하지 않고, 희귀 단어에 대해서는 의미있는 subwords로 분할한다.  \n","예를 들어 annoyingly를 annoying+ly로 분해해 annoying과 ly의 합성의미로 유지"],"metadata":{"id":"4rUpOufUsFmy"}},{"cell_type":"markdown","source":["## 토크나이저 로딩 및 저장"],"metadata":{"id":"SBAD-sgsuBEf"}},{"cell_type":"code","source":["# Bert와 동일한 checkpoint로 학습된 bert tokenizer\n","from transformers import BertTokenizer\n","tokenizer = BertTokenizer.from_pretrained(\"bert-base-cased\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":81,"referenced_widgets":["b029742bf3ff4266b7a76af9d187045c","c56d64506f464660a4149c3f178cd78f","48ee5d6bcd6b423ab4311aab34d92d05","e8d767dc0d004b739102101a0ef9dda7","495c8ce24245463c9f9f65f7c139872e","86ec4496cf3240ef8d3a2fccf6bd515e","04ac781e185c45b088c3df890165b83c","ed7a5cc58f76431db5e3cdbd9c163abf","77ad8747434940059d99936333c4b257","e30b868fab8b46a98dbe9df97ac645cc","e03b2c0fa31341f48f6f45d77a53525f","4ba2b9f3490842be94a7629a6412d696","96b86f50e96c4d3ab595e434d175cd20","21affbc98c424c3ab966e28e57ec0996","8aa3078141314924a934d35c1c9507b9","1a2cd04b12bb4f10a9a04db07cf70386","f8728c2ff18a4d2fb3ca41a9555ec521","7070bebe6c164a6fa93c04db91160e73","4314cc54247a4cdb8692b12683a11d9a","145c537ece8b49609b6e1c9e2a8998f1","44394e75e01a410ab1acd6c100e9c1d9","18f0e0a64c7d44a8876ad20a20e5189f"]},"id":"khtLO63Rp-IR","executionInfo":{"status":"ok","timestamp":1668523889917,"user_tz":-540,"elapsed":1593,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"bce5c336-6fa7-4b58-8329-5ebfd9da69c7"},"execution_count":37,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/213k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b029742bf3ff4266b7a76af9d187045c"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/29.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"4ba2b9f3490842be94a7629a6412d696"}},"metadata":{}}]},{"cell_type":"code","source":["from transformers import AutoTokenizer\n","tokenizer = AutoTokenizer.from_pretrained(\"bert-base-cased\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["97579bd7aa39458db69b9c0611e87410","e6582ff150ba4f02afdca0416b1ad7fa","459bfc275f4e4be4b1afc6d847e37996","3628622ae3da4bacb27e09f9bf5c75a7","805580269c2342959bf9178ed2123841","e412e0c20bdf44f6ba44faebfe73f528","ac842f139d3a4c1a8ebe3f3cd851d08e","158f896f6b9c4668bc54f419e9b3c5ed","c2dc52bb1ca7449c8709e31beac70a1c","f70e4665166b4057855e63dd6a63f492","0db494c02ee243dbbf7dc6873e95a69d"]},"id":"LXNVcXJYxgoV","executionInfo":{"status":"ok","timestamp":1668524843794,"user_tz":-540,"elapsed":565,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"86ce5c21-dcdb-4555-8dc4-c8f289647a93"},"execution_count":38,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/436k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"97579bd7aa39458db69b9c0611e87410"}},"metadata":{}}]},{"cell_type":"code","source":["tokenizer(\"Using a Transformer network is simple\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"iJIfQWw91JxZ","executionInfo":{"status":"ok","timestamp":1668524856023,"user_tz":-540,"elapsed":277,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"9ca31025-42fa-4cd7-b12f-6749a8fb8d51"},"execution_count":39,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'input_ids': [101, 7993, 170, 13809, 23763, 2443, 1110, 3014, 102], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1]}"]},"metadata":{},"execution_count":39}]},{"cell_type":"code","source":["# 모델 저장과 동일하게 토크나이저를 저장할 수 있음\n","tokenizer.save_pretrained(\"saving_folder\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GY0nAt0H1M7O","executionInfo":{"status":"ok","timestamp":1668524891071,"user_tz":-540,"elapsed":569,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"3c651ee3-c0cf-4299-e15b-a7cfd7f2c666"},"execution_count":40,"outputs":[{"output_type":"execute_result","data":{"text/plain":["('saving_folder/tokenizer_config.json',\n"," 'saving_folder/special_tokens_map.json',\n"," 'saving_folder/vocab.txt',\n"," 'saving_folder/added_tokens.json',\n"," 'saving_folder/tokenizer.json')"]},"metadata":{},"execution_count":40}]},{"cell_type":"markdown","source":["## Encoding\n","텍스트를 숫자로 변환하는 과정  \n","토큰화와 입력 식별자(숫자)로의 변환의 2단계 프로세스를 수행\n","토큰화: 텍스트를 토큰으로 분리  \n","입력 식별자로의 전환: 토큰들을 숫자로 변환하여 tensor로 만들어 이를 모델에 입력할 수 있도록 함\n"],"metadata":{"id":"Z3_TyyIL1aKE"}},{"cell_type":"markdown","source":["### 토큰화 작업"],"metadata":{"id":"affpjugb2a7R"}},{"cell_type":"code","source":["from transformers import AutoTokenizer\n","\n","tokenizer = AutoTokenizer.from_pretrained(\"bert-base-cased\")\n","\n","sequence = \"Using a Transformer network is simple\"\n","tokens = tokenizer.tokenize(sequence)\n","\n","print(tokens)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3WkCsL6L1VUM","executionInfo":{"status":"ok","timestamp":1668525745279,"user_tz":-540,"elapsed":5,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"86ab36bc-780a-44cb-c8d7-75ea4e4c901d"},"execution_count":41,"outputs":[{"output_type":"stream","name":"stdout","text":["['Using', 'a', 'Trans', '##former', 'network', 'is', 'simple']\n"]}]},{"cell_type":"markdown","source":["### 토큰을 입력 식별자로 변환(From tokens to input IDs)"],"metadata":{"id":"B4Ivl_X25gTY"}},{"cell_type":"code","source":["ids = tokenizer.convert_tokens_to_ids(tokens)\n","print(ids)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"r87NsnjN4lsO","executionInfo":{"status":"ok","timestamp":1668526015095,"user_tz":-540,"elapsed":3,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"b1f8829d-cac9-49e6-a423-8ef31ecbc2f5"},"execution_count":43,"outputs":[{"output_type":"stream","name":"stdout","text":["[7993, 170, 13809, 23763, 2443, 1110, 3014]\n"]}]},{"cell_type":"markdown","source":["## Decoding\n","입력 식별자를 이용해서 어휘집에서 해당 문자열을 찾음\n","인덱스를 다시 토큰으로 변환활 뿐 아니라 하위 단어로 분할된 토큰을 병합하여 읽을 수 있는 원본 문장을 도출  \n","\n","\n"],"metadata":{"id":"YNsmj6xG5rxJ"}},{"cell_type":"code","source":["decoded_string = tokenizer.decode(ids)\n","print(decoded_string)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rHlW-SxP5mV2","executionInfo":{"status":"ok","timestamp":1668526288578,"user_tz":-540,"elapsed":418,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"9bcd3017-20e6-4fdb-c83d-bacfb64e56ac"},"execution_count":45,"outputs":[{"output_type":"stream","name":"stdout","text":["Using a Transformer network is simple\n"]}]},{"cell_type":"markdown","source":["#4. 다중 시퀀스 처리"],"metadata":{"id":"pl3j5c2163aQ"}},{"cell_type":"code","source":["checkpoint = \"distilbert-base-uncased-finetuned-sst-2-english\"\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)\n","model = AutoModelForSequenceClassification.from_pretrained(checkpoint)\n","\n","sequence = \"I've been waiting for a HuggingFace course my whole life.\"\n","\n","tokens = tokenizer.tokenize(sequence)\n","ids = tokenizer.convert_tokens_to_ids(tokens)\n","input_ids = torch.tensor([ids])\n","# This line will fail\n","# transformers모델은 기본적으로 다중 문장 시퀀스를 입력받기를 기대하기 때문에 단일 시퀀스를 입력하자 오류가 발생한 것\n","print(\"Input IDs:\", input_ids)\n","\n","output = model(input_ids)\n","print(\"Logits:\", output.logits)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"o2kp949V6old","executionInfo":{"status":"ok","timestamp":1668528332970,"user_tz":-540,"elapsed":1846,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"74cd370f-c3bd-498a-926b-c0130f9f6d5e"},"execution_count":51,"outputs":[{"output_type":"stream","name":"stdout","text":["Input IDs: tensor([[ 1045,  1005,  2310,  2042,  3403,  2005,  1037, 17662, 12172,  2607,\n","          2026,  2878,  2166,  1012]])\n","Logits: tensor([[-2.7276,  2.8789]], grad_fn=<AddmmBackward0>)\n"]}]},{"cell_type":"markdown","source":["텐서의 형태는 항상 직사각형 모양이어야 하기 때문에 입력식별자 리스트를 같은 길이로 맞춰주기 위해 padding을 해야한다."],"metadata":{"id":"e3CIj8SACjU2"}},{"cell_type":"markdown","source":["## Input Padding하기"],"metadata":{"id":"zxndAn-HCrDm"}},{"cell_type":"code","source":["model = AutoModelForSequenceClassification.from_pretrained(checkpoint)\n","\n","sequence1_ids = [[200, 200, 200]]\n","sequence2_ids = [[200, 200]]\n","batched_ids = [\n","    [200, 200, 200],\n","    [200, 200, tokenizer.pad_token_id],\n","]\n","# tokenizer.pad_token_id에는 padding token의 식별자(ID)가 지정되어 있음\n","\n","print(model(torch.tensor(sequence1_ids)).logits)\n","print(model(torch.tensor(sequence2_ids)).logits)\n","print(model(torch.tensor(batched_ids)).logits)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7gey8ixD-kj8","executionInfo":{"status":"ok","timestamp":1668528551280,"user_tz":-540,"elapsed":2048,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"5c4071f7-4fe0-4b04-fe31-db96d5e079d4"},"execution_count":53,"outputs":[{"output_type":"stream","name":"stdout","text":["tensor([[ 1.5694, -1.3895]], grad_fn=<AddmmBackward0>)\n","tensor([[ 0.5803, -0.4125]], grad_fn=<AddmmBackward0>)\n","tensor([[ 1.5694, -1.3895],\n","        [ 1.3374, -1.2163]], grad_fn=<AddmmBackward0>)\n"]}]},{"cell_type":"markdown","source":["마지막 input의 두번째 row는 결과가 두번째와 같아야 하는데 다르다. 이는 attention layer가 시퀀스의 모든 토큰에 집중하면서 패딩 토큰에도 집중하기 때문인데, 따라서 attention layer가 패딩 토큰을 무시하도록 지시해야한다."],"metadata":{"id":"A0nqjcQODaIo"}},{"cell_type":"markdown","source":["## Attention Mask"],"metadata":{"id":"Jocd8vdlDrMh"}},{"cell_type":"code","source":["batched_ids = [\n","    [200, 200, 200],\n","    [200, 200, tokenizer.pad_token_id],\n","]\n","\n","attention_mask = [\n","    [1, 1, 1],\n","    [1, 1, 0],\n","]\n","\n","outputs = model(torch.tensor(batched_ids), attention_mask = torch.tensor(attention_mask))\n","print(outputs.logits)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"sZa_wlrTCyQ2","executionInfo":{"status":"ok","timestamp":1668528723557,"user_tz":-540,"elapsed":286,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"e1483173-f6c5-4567-d804-b9d2819fb322"},"execution_count":56,"outputs":[{"output_type":"stream","name":"stdout","text":["tensor([[ 1.5694, -1.3895],\n","        [ 0.5803, -0.4125]], grad_fn=<AddmmBackward0>)\n"]}]},{"cell_type":"markdown","source":["결과가 같아졌다!"],"metadata":{"id":"TwvczVSTD-1e"}},{"cell_type":"markdown","source":["## 길이가 더 긴 시퀀스들"],"metadata":{"id":"wxODuW-dEGsf"}},{"cell_type":"markdown","source":["Transformer는 모델에 입력할 수 있는 시퀀스의 길이에 제한이 있는데, 대부분의 모델이 최대 512/1024개 토큰 시퀀스를 처리하며, 그보다 긴 시퀀스의 처리를 요구 받으면 오류를 발생시킨다.  \n","이에 대한 솔루션으로는 \n","\n","* 길이가 더 긴 시퀀스를 지원하는 모델 사용\n","* Truncation(시퀀스를 절단하기)\n","가 있다. "],"metadata":{"id":"3EYkVvTiEJLz"}},{"cell_type":"code","source":["max_sequence_length = 512\n","sequence = sequence[:max_sequence_length]"],"metadata":{"id":"0vVhzaNHD07r","executionInfo":{"status":"ok","timestamp":1668528871565,"user_tz":-540,"elapsed":3,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}}},"execution_count":57,"outputs":[]},{"cell_type":"markdown","source":["## Using Transformer API"],"metadata":{"id":"JqX9umwlEoEy"}},{"cell_type":"code","source":["checkpoint = \"distilbert-base-uncased-finetuned-sst-2-english\"\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)\n","\n","# 단일 시퀀스 토큰화\n","sequence = \"I've been waiting for a HugginFace course my whole life.\"\n","model_inputs = tokenizer(sequence)\n","## 다중 시퀀스 토큰화\n","sequences = [\"I've been waiting for a HugginFace course my whole life.\", \"So have I!\"]\n","model_inputs = tokenizer(sequences)"],"metadata":{"id":"TElkHMKhEhNr","executionInfo":{"status":"ok","timestamp":1668529058584,"user_tz":-540,"elapsed":382,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}}},"execution_count":60,"outputs":[]},{"cell_type":"code","source":["# 해당 시퀀스를 리스트 내 최장 시퀀스 길이까지 padding\n","model_inputs = tokenizer(sequences, padding = \"longest\")\n","print(model_inputs)\n","# 해당 시퀀스를 모델 최대 길이까지 padding\n","model_inputs = tokenizer(sequences, padding = \"max_length\")\n","print(model_inputs)\n","# 지정된 최대 길이까지 시퀀스를 padding\n","model_inputs = tokenizer(sequences, padding = \"max_length\", max_length = 8)\n","print(model_inputs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"SGxNJq4fFNrl","executionInfo":{"status":"ok","timestamp":1668529168051,"user_tz":-540,"elapsed":4,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"07b830d6-de28-45d1-821c-231d1576f161"},"execution_count":62,"outputs":[{"output_type":"stream","name":"stdout","text":["{'input_ids': [[101, 1045, 1005, 2310, 2042, 3403, 2005, 1037, 8549, 11528, 12172, 2607, 2026, 2878, 2166, 1012, 102], [101, 2061, 2031, 1045, 999, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]], 'attention_mask': [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]}\n","{'input_ids': [[101, 1045, 1005, 2310, 2042, 3403, 2005, 1037, 8549, 11528, 12172, 2607, 2026, 2878, 2166, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [101, 2061, 2031, 1045, 999, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]], 'attention_mask': [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]}\n","{'input_ids': [[101, 1045, 1005, 2310, 2042, 3403, 2005, 1037, 8549, 11528, 12172, 2607, 2026, 2878, 2166, 1012, 102], [101, 2061, 2031, 1045, 999, 102, 0, 0]], 'attention_mask': [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 0, 0]]}\n"]}]},{"cell_type":"markdown","source":["자동으로 어텐션 마스킹까지 된 것을 확인할 수 있다."],"metadata":{"id":"OWuNqjEyFwPW"}},{"cell_type":"code","source":["sequences = [\"I've been waiting for a HugginFace course my whole life.\", \"So have I!\"]\n","\n","# 모델 최대 길이보다 긴 시퀀스 truncate\n","model_inputs = tokenizer(sequences, truncation = True)\n","print(model_inputs)\n","\n","# 지정된 최대 길이보다 긴 시퀀스 truncate\n","model_inputs = tokenizer(sequences, max_length = 8, truncation = True)\n","print(model_inputs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bpGgsh-oFQHM","executionInfo":{"status":"ok","timestamp":1668529315935,"user_tz":-540,"elapsed":326,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"9428f6b8-847e-4e3b-bda7-7397bc72e734"},"execution_count":64,"outputs":[{"output_type":"stream","name":"stdout","text":["{'input_ids': [[101, 1045, 1005, 2310, 2042, 3403, 2005, 1037, 8549, 11528, 12172, 2607, 2026, 2878, 2166, 1012, 102], [101, 2061, 2031, 1045, 999, 102]], 'attention_mask': [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1]]}\n","{'input_ids': [[101, 1045, 1005, 2310, 2042, 3403, 2005, 102], [101, 2061, 2031, 1045, 999, 102]], 'attention_mask': [[1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1]]}\n"]}]},{"cell_type":"markdown","source":["## 특수 토큰들"],"metadata":{"id":"htsIrIBqGZq6"}},{"cell_type":"code","source":["sequence = \"I've been waiting for a HugginFace course my whole life.\"\n","model_inputs = tokenizer(sequence)\n","print(model_inputs[\"input_ids\"])\n","\n","tokens = tokenizer.tokenize(sequence)\n","ids = tokenizer.convert_tokens_to_ids(tokens)\n","print(ids)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"XlYAJ3ZVGLVo","executionInfo":{"status":"ok","timestamp":1668529438625,"user_tz":-540,"elapsed":2,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"bc9b3c9a-1773-4e2f-92e6-9d5196c31938"},"execution_count":66,"outputs":[{"output_type":"stream","name":"stdout","text":["[101, 1045, 1005, 2310, 2042, 3403, 2005, 1037, 8549, 11528, 12172, 2607, 2026, 2878, 2166, 1012, 102]\n","[1045, 1005, 2310, 2042, 3403, 2005, 1037, 8549, 11528, 12172, 2607, 2026, 2878, 2166, 1012]\n"]}]},{"cell_type":"markdown","source":["앞 뒤로 id가 하나씩 추가된 것을 확인할 수 있다. 이를 디코딩하여 각각 무엇을 나타내는지 알아보자."],"metadata":{"id":"z-npU12RGuUM"}},{"cell_type":"code","source":["print(tokenizer.decode(model_inputs[\"input_ids\"]))\n","print(tokenizer.decode(ids))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-LC7y6NVGor1","executionInfo":{"status":"ok","timestamp":1668529493672,"user_tz":-540,"elapsed":431,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"68dd8e94-84d0-4cc7-f93a-7482edbb3d34"},"execution_count":68,"outputs":[{"output_type":"stream","name":"stdout","text":["[CLS] i've been waiting for a hugginface course my whole life. [SEP]\n","i've been waiting for a hugginface course my whole life.\n"]}]},{"cell_type":"markdown","source":["시작 부분에 [CLS]가, 끝 부분에 [SEP]가 추가된 것을 확인할 수 있다.  \n","이는 모델이 해당 특수 토큰들로 pre-train됐기 때문이다. "],"metadata":{"id":"HkBRsWBdG6zn"}},{"cell_type":"markdown","source":["## 마무리: 토크나이저에서 모델로...\n","주요 API를 이용하여 다중 시퀀스, 매우 킨 시퀀스, 여러 유형의 텐서를 처리하기"],"metadata":{"id":"UCHrOYm1HHgo"}},{"cell_type":"code","source":["checkpoint = \"distilbert-base-uncased-finetuned-sst-2-english\"\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)\n","model = AutoModelForSequenceClassification.from_pretrained(checkpoint)\n","\n","sequences = [\"I've been waiting for a HugginFace course my whole life.\", \"So have I!\"]\n","\n","tokens = tokenizer(sequences, padding = True, truncation = True, return_tensors = \"pt\")\n","# padding = true: 해당 시퀀스 리스트 내 최대 시퀀스 길이까지 padding\n","# truncation = true: 모델의 최대 길이보다 긴 시퀀스 truncate, 512 for distilbert\n","output = model(**tokens)\n","print(output)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dnnpx6j9G3we","executionInfo":{"status":"ok","timestamp":1668529678734,"user_tz":-540,"elapsed":2017,"user":{"displayName":"Woo Young Cho","userId":"12554648073850893573"}},"outputId":"570ecb06-4c25-4ae1-f3de-b23a88261ec4"},"execution_count":70,"outputs":[{"output_type":"stream","name":"stdout","text":["SequenceClassifierOutput(loss=None, logits=tensor([[-2.5268,  2.6123],\n","        [-3.6183,  3.9137]], grad_fn=<AddmmBackward0>), hidden_states=None, attentions=None)\n"]}]}]}